<!DOCTYPE html>
<html lang="en"><head>
<script src="Aula06_files/libs/clipboard/clipboard.min.js"></script>
<script src="Aula06_files/libs/quarto-html/tabby.min.js"></script>
<script src="Aula06_files/libs/quarto-html/popper.min.js"></script>
<script src="Aula06_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="Aula06_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Aula06_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="Aula06_files/libs/quarto-html/quarto-syntax-highlighting-3e476e15ae565c222d94875412ae43a1.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.39">

  <meta name="author" content="Prof.&nbsp;Carlos Trucíos  ctrucios@unicamp.br">
  <title>Modelos de regressão em dados de séries temporais II</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="Aula06_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="Aula06_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #767676;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #767676;  padding-left: 4px; }
    div.sourceCode
      { color: #545454; background-color: #fefefe; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #545454; } /* Normal */
    code span.al { color: #7928a1; } /* Alert */
    code span.an { color: #696969; } /* Annotation */
    code span.at { color: #a55a00; } /* Attribute */
    code span.bn { color: #7928a1; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #d91e18; } /* ControlFlow */
    code span.ch { color: #008000; } /* Char */
    code span.cn { color: #d91e18; } /* Constant */
    code span.co { color: #696969; } /* Comment */
    code span.cv { color: #696969; font-style: italic; } /* CommentVar */
    code span.do { color: #696969; font-style: italic; } /* Documentation */
    code span.dt { color: #7928a1; } /* DataType */
    code span.dv { color: #7928a1; } /* DecVal */
    code span.er { color: #7928a1; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #a55a00; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #696969; } /* Information */
    code span.kw { color: #d91e18; } /* Keyword */
    code span.op { color: #00769e; } /* Operator */
    code span.ot { color: #d91e18; } /* Other */
    code span.pp { color: #7928a1; } /* Preprocessor */
    code span.sc { color: #00769e; } /* SpecialChar */
    code span.ss { color: #008000; } /* SpecialString */
    code span.st { color: #008000; } /* String */
    code span.va { color: #a55a00; } /* Variable */
    code span.vs { color: #008000; } /* VerbatimString */
    code span.wa { color: #696969; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="Aula06_files/libs/revealjs/dist/theme/quarto-312e06f9632ef9de479b377823fa59dd.css">
  <link href="Aula06_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="Aula06_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="Aula06_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="Aula06_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="Aula06_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="Aula06_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <link href="Aula06_files/libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
  <script src="Aula06_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
  <script src="Aula06_files/libs/plotly-binding-4.10.4/plotly.js"></script>
  <script src="Aula06_files/libs/typedarray-0.1/typedarray.min.js"></script>
  <script src="Aula06_files/libs/jquery-3.5.1/jquery.min.js"></script>
  <link href="Aula06_files/libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
  <script src="Aula06_files/libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
  <link href="Aula06_files/libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
  <script src="Aula06_files/libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-image="imagens/unicamp.png" data-background-opacity="1" data-background-position="99% 5%" data-background-size="20%" class="quarto-title-block center">
  <h1 class="title">Modelos de regressão em dados de séries temporais II</h1>
  <p class="subtitle">ME607 - Séries Temporais</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Prof.&nbsp;Carlos Trucíos <br> ctrucios@unicamp.br 
</div>
        <p class="quarto-title-affiliation">
            Instituto de Matemática, Estatística e Computação Científica (IMECC), <br> Universidade Estadual de Campinas (UNICAMP).
          </p>
    </div>
</div>

</section><section id="TOC">
<nav role="doc-toc"> 
<h2 id="toc-title">Agenda</h2>
<ul>
<li class="fragment"><a href="#/introdução" id="/toc-introdução">Introdução</a></li>
<li class="fragment"><a href="#/tendência-sazonalidade" id="/toc-tendência-sazonalidade">Tendência + Sazonalidade</a></li>
<li class="fragment"><a href="#/previsão" id="/toc-previsão">Previsão</a></li>
<li class="fragment"><a href="#/não-lineariedades" id="/toc-não-lineariedades">Não lineariedades</a></li>
<li class="fragment"><a href="#/comentários-finais" id="/toc-comentários-finais">Comentários finais</a></li>
</ul>
</nav>
</section>
<section>
<section id="introdução" class="title-slide slide level1 center">
<h1>Introdução</h1>

</section>
<section id="introdução-1" class="slide level2">
<h2>Introdução</h2>
<ul>
<li class="fragment">Na aula anterior vimos como incluir termos de tendência:
<ul>
<li class="fragment">Tendência Linear: <span class="math inline">\(y_t = \alpha_0 + \alpha_1 t + e_t\)</span>,</li>
<li class="fragment">Tendência Quadrática: <span class="math inline">\(y_t = \alpha_0 + \alpha_1 t + \alpha_2 t^2 + e_t\)</span>,</li>
<li class="fragment">Tendência Cúbica: <span class="math inline">\(y_t = \alpha_0 + \alpha_1 t + \alpha_2 t^2 +  \alpha_3 t^3 + e_t\)</span>.</li>
</ul></li>
<li class="fragment">Na aula de hoje aprenderemos a utilizar outros preditores úteis quando trabalhamos com modelos de regressão em um contexto de séries temporais.</li>
<li class="fragment">Discutiremos como fazer previsão neste tipo de modelos.</li>
</ul>
</section>
<section id="regressores-úteis" class="slide level2">
<h2>Regressores úteis</h2>
<h4 id="variáveis-dummy">Variáveis Dummy</h4>
<ul>
<li class="fragment">Utilizada para tomar conta das diferenças nos diversos períodos sazonais.</li>
<li class="fragment">Utilizada para dividir períodos de tempo. Por exemplo:
<ul>
<li class="fragment">posicionamento politico na presidencia: direita ou esquerda,</li>
<li class="fragment">período covid: antes do covid e depois do covid (março 12, 2020),</li>
<li class="fragment">antes e depois do 11-09-2001,</li>
<li class="fragment">antes e depois de determinada politica na empresa (ou politica pública),</li>
<li class="fragment">feriados</li>
<li class="fragment">eventos raros: copa do mundo, jogos olimpicos, etc.</li>
</ul></li>
</ul>
</section>
<section id="regressores-úteis-1" class="slide level2">
<h2>Regressores úteis</h2>
<h4 id="variáveis-dummy-1">Variáveis Dummy</h4>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">dias</th>
<th style="text-align: right;">D1</th>
<th style="text-align: right;">D2</th>
<th style="text-align: right;">D3</th>
<th style="text-align: right;">D4</th>
<th style="text-align: right;">D5</th>
<th style="text-align: right;">D6</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Segunda</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Terça</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Quarta</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Quinta</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sexta</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sábado</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Domingo</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Segunda</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="regressores-úteis-2" class="slide level2">
<h2>Regressores úteis</h2>
<h4 id="variáveis-dummy-2">Variáveis Dummy</h4>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">Estacoes</th>
<th style="text-align: right;">D1</th>
<th style="text-align: right;">D2</th>
<th style="text-align: right;">D3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Primaveira</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Verão</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Outono</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Inverno</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primaveira</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Verão</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="regressores-úteis-3" class="slide level2">
<h2>Regressores úteis</h2>
<h4>
Dias de negociação
</h4>
<p>Dependo do que queremos prever, o numero de dias úteis (ou dias de negociação) pode influenciar em, por exemplo, o volume de vendas mensal.</p>
<ul>
<li class="fragment">Incluir uma variável com o número de dias úteis no mês pode ser útil para nosso modelo.</li>
<li class="fragment">Outra alternativa é incluir o número de cada dia da semana em que houve negociação. Por exemplo:</li>
</ul>
<div class="fragment">
<center>
<div>
<ul>
<li><span class="math inline">\(x_1:\)</span> número de segundas-feiras no mês.</li>
<li><span class="math inline">\(x_2:\)</span> número de terças-feiras no mês.</li>
<li><span class="math inline">\(\vdots\)</span></li>
<li><span class="math inline">\(x_6:\)</span> número de sábados no mês.</li>
<li><span class="math inline">\(x_7:\)</span> número de domingos no mês.</li>
</ul>
</div>
</center>
</div>
</section>
<section id="regressores-úteis-4" class="slide level2">
<h2>Regressores úteis</h2>
<h4>
Variáveis defasadas
</h4>
<p>Podemos pensar que, por exemplo, o número de vendas depende dos gastos em publicidade. Contudo, às vezes os gastos em publicidade do mês anterior poderiam ter um efeito nas vendas do mês atual. Nesse sentido, incluir variáveis defasadas pode ajudar a melhorar o modelo.</p>
<div class="fragment">
<center>
<div>
<ul>
<li><span class="math inline">\(x_1:\)</span> gasto em publicidade no mês anterior.</li>
<li><span class="math inline">\(x_2:\)</span> gasto em publicidade há dois meses.</li>
<li><span class="math inline">\(\vdots\)</span></li>
<li><span class="math inline">\(x_m:\)</span> gasto em publicidade há <span class="math inline">\(m\)</span> meses.</li>
</ul>
</div>
</center>
</div>
</section>
<section id="regressores-úteis-5" class="slide level2">
<h2>Regressores úteis</h2>
<h4>
Páscoa
</h4>
<p>A páscoa não acontece todo ano no mesmo periodo, páscoa pode afetar diferentes negócios (turismo, por exemplo). Incluir no modelo uma variável que tome conta desse fator pode ser interessante. Nestes casos podemos:</p>
<ul>
<li class="fragment">Incluir variáveis dummy nos dias da páscoa,</li>
<li class="fragment">Se trabalharmos com dados mensais, incluir uma dummy no mês que a páscoa cair.</li>
</ul>
</section>
<section id="regressores-úteis-6" class="slide level2">
<h2>Regressores úteis</h2>
<h4>
Séries de Fourier
</h4>
<ul>
<li class="fragment">É uma alternativa ao uso de variáveis dummy em dados sazonais.</li>
<li class="fragment">Para um período sazonal <span class="math inline">\(m\)</span> temos:</li>
</ul>
<div class="fragment">
<center>
<div>
<ul>
<li><span class="math inline">\(x_1 = \sin(\dfrac{2\pi t}{m}), \quad x_2 = \cos(\dfrac{2\pi t}{m}),\)</span></li>
<li><span class="math inline">\(x_3 = \sin(\dfrac{4\pi t}{m}), \quad x_4 = \cos(\dfrac{4\pi t}{m}),\)</span></li>
<li><span class="math inline">\(x_5 = \sin(\dfrac{6\pi t}{m}), \quad x_6 = \cos(\dfrac{6\pi t}{m}),\)</span></li>
<li><span class="math inline">\(\vdots\)</span></li>
</ul>
</div>
</center>
</div>
<div class="fragment">
<blockquote>
<p>Uma regressão que inclui termos de Fourier, é chamada “modelo de regressao harmônica”.</p>
</blockquote>
</div>
</section></section>
<section>
<section id="tendência-sazonalidade" class="title-slide slide level1 center">
<h1>Tendência + Sazonalidade</h1>

</section>
<section id="tendência-sazonalidade-1" class="slide level2">
<h2>Tendência + Sazonalidade</h2>
<div class="callout callout-warning no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Lembrando</strong></p>
</div>
<div class="callout-content">
<p>A decomposição de séries temporais pode ser definida como</p>
<p><span class="math display">\[\underbrace{Y_t = T_t + S_t + R_t}_{\text{Modelo aditivo}} \quad ou \quad \underbrace{Y_t = T_t \times S_t \times R_t}_{\text{Modelo  multiplicativo}}\]</span></p>
</div>
</div>
</div>
<div class="fragment">
<p>Fazendo algumas modificações, podemos transformar a equação acima em um modelo de regressão da forma</p>
<p><span class="math display">\[Y_t = \beta_0 + \beta_1 T_t + \beta_2 S_t + \epsilon_t\]</span></p>
</div>
<div class="fragment">
<p><span class="math display">\[\text{ou} \quad \log(Y_t) = \beta_0 + \beta_1 \log(T_t) + \beta_2 \log(S_t) + \epsilon_t\]</span></p>
<p>Bastando apenas saber quem utilizarmos como <span class="math inline">\(T_t\)</span> e quem como <span class="math inline">\(S_t\)</span>.</p>
</div>
</section>
<section id="tendência-sazonalidade-2" class="slide level2">
<h2>Tendência + Sazonalidade</h2>
<ul>
<li class="fragment">Já temos aprendido como lidar com <span class="math inline">\(T_t\)</span>:
<ul>
<li class="fragment">Tendência Linear: <span class="math inline">\(y_t = \alpha_0 + \alpha_1 t + e_t\)</span>,</li>
<li class="fragment">Tendência Quadrática: <span class="math inline">\(y_t = \alpha_0 + \alpha_1 t + \alpha_2 t^2 + e_t\)</span>,</li>
<li class="fragment">Tendência Cúbica: <span class="math inline">\(y_t = \alpha_0 + \alpha_1 t + \alpha_2 t^2 +  \alpha_3 t^3 + e_t\)</span>.</li>
<li class="fragment">etc.</li>
</ul></li>
<li class="fragment">Para <span class="math inline">\(S_t\)</span> podemos:
<ul>
<li class="fragment">Utilizar variáveis <strong>dummy</strong></li>
<li class="fragment">Utilizar regressores de <strong>Fourier</strong></li>
</ul></li>
</ul>
</section>
<section id="tendência-sazonalidade-3" class="slide level2">
<h2>Tendência + Sazonalidade</h2>
<div class="panel-tabset">
<ul id="tabset-1" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-1-1">Dados</a></li><li><a href="#tabset-1-2">FE</a></li><li><a href="#tabset-1-3">Modelling</a></li><li><a href="#tabset-1-4">Plot</a></li><li><a href="#tabset-1-5">tslm</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href=""></a><span class="fu">library</span>(TSstudio)</span>
<span id="cb1-2"><a href=""></a><span class="fu">library</span>(lubridate)</span>
<span id="cb1-3"><a href=""></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-4"><a href=""></a><span class="fu">ts_info</span>(USgas)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> The USgas series is a ts object with 1 variable and 238 observations
 Frequency: 12 
 Start time: 2000 1 
 End time: 2019 10 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href=""></a><span class="fu">ts_plot</span>(USgas,</span>
<span id="cb3-2"><a href=""></a>  <span class="at">title =</span> <span class="st">"US Monthly Natural Gas consumption"</span>,</span>
<span id="cb3-3"><a href=""></a>  <span class="at">Ytitle =</span> <span class="st">"Billion Cubic Feet"</span>,</span>
<span id="cb3-4"><a href=""></a>  <span class="at">Xtitle =</span> <span class="st">"Year"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-4f978b22a5f4146d7b6b" style="width:960px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-4f978b22a5f4146d7b6b">{"x":{"visdat":{"12ab02600608a":["function () ","plotlyVisDat"]},"cur_data":"12ab02600608a","attrs":{"12ab02600608a":{"x":{},"y":{},"mode":"lines","line":{"width":2,"dash":null,"color":"#00526d"},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"Year","showgrid":false},"yaxis":{"domain":[0,1],"automargin":true,"title":"Billion Cubic Feet","showgrid":false},"title":"US Monthly Natural Gas consumption","hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[2000,2000.0833333333333,2000.1666666666667,2000.25,2000.3333333333333,2000.4166666666667,2000.5,2000.5833333333333,2000.6666666666667,2000.75,2000.8333333333333,2000.9166666666667,2001,2001.0833333333333,2001.1666666666667,2001.25,2001.3333333333333,2001.4166666666667,2001.5,2001.5833333333333,2001.6666666666667,2001.75,2001.8333333333333,2001.9166666666667,2002,2002.0833333333333,2002.1666666666667,2002.25,2002.3333333333333,2002.4166666666667,2002.5,2002.5833333333333,2002.6666666666667,2002.75,2002.8333333333333,2002.9166666666667,2003,2003.0833333333333,2003.1666666666667,2003.25,2003.3333333333333,2003.4166666666667,2003.5,2003.5833333333333,2003.6666666666667,2003.75,2003.8333333333333,2003.9166666666667,2004,2004.0833333333333,2004.1666666666667,2004.25,2004.3333333333333,2004.4166666666667,2004.5,2004.5833333333333,2004.6666666666667,2004.75,2004.8333333333333,2004.9166666666667,2005,2005.0833333333333,2005.1666666666667,2005.25,2005.3333333333333,2005.4166666666667,2005.5,2005.5833333333333,2005.6666666666667,2005.75,2005.8333333333333,2005.9166666666667,2006,2006.0833333333333,2006.1666666666667,2006.25,2006.3333333333333,2006.4166666666667,2006.5,2006.5833333333333,2006.6666666666667,2006.75,2006.8333333333333,2006.9166666666667,2007,2007.0833333333333,2007.1666666666667,2007.25,2007.3333333333333,2007.4166666666667,2007.5,2007.5833333333333,2007.6666666666667,2007.75,2007.8333333333333,2007.9166666666667,2008,2008.0833333333333,2008.1666666666667,2008.25,2008.3333333333333,2008.4166666666667,2008.5,2008.5833333333333,2008.6666666666667,2008.75,2008.8333333333333,2008.9166666666667,2009,2009.0833333333333,2009.1666666666667,2009.25,2009.3333333333333,2009.4166666666667,2009.5,2009.5833333333333,2009.6666666666667,2009.75,2009.8333333333333,2009.9166666666667,2010,2010.0833333333333,2010.1666666666667,2010.25,2010.3333333333333,2010.4166666666667,2010.5,2010.5833333333333,2010.6666666666667,2010.75,2010.8333333333333,2010.9166666666667,2011,2011.0833333333333,2011.1666666666667,2011.25,2011.3333333333333,2011.4166666666667,2011.5,2011.5833333333333,2011.6666666666667,2011.75,2011.8333333333333,2011.9166666666667,2012,2012.0833333333333,2012.1666666666667,2012.25,2012.3333333333333,2012.4166666666667,2012.5,2012.5833333333333,2012.6666666666667,2012.75,2012.8333333333333,2012.9166666666667,2013,2013.0833333333333,2013.1666666666667,2013.25,2013.3333333333333,2013.4166666666667,2013.5,2013.5833333333333,2013.6666666666667,2013.75,2013.8333333333333,2013.9166666666667,2014,2014.0833333333333,2014.1666666666667,2014.25,2014.3333333333333,2014.4166666666667,2014.5,2014.5833333333333,2014.6666666666667,2014.75,2014.8333333333333,2014.9166666666667,2015,2015.0833333333333,2015.1666666666667,2015.25,2015.3333333333333,2015.4166666666667,2015.5,2015.5833333333333,2015.6666666666667,2015.75,2015.8333333333333,2015.9166666666667,2016,2016.0833333333333,2016.1666666666667,2016.25,2016.3333333333333,2016.4166666666667,2016.5,2016.5833333333333,2016.6666666666667,2016.75,2016.8333333333333,2016.9166666666667,2017,2017.0833333333333,2017.1666666666667,2017.25,2017.3333333333333,2017.4166666666667,2017.5,2017.5833333333333,2017.6666666666667,2017.75,2017.8333333333333,2017.9166666666667,2018,2018.0833333333333,2018.1666666666667,2018.25,2018.3333333333333,2018.4166666666667,2018.5,2018.5833333333333,2018.6666666666667,2018.75,2018.8333333333333,2018.9166666666667,2019,2019.0833333333333,2019.1666666666667,2019.25,2019.3333333333333,2019.4166666666667,2019.5,2019.5833333333333,2019.6666666666667,2019.75],"y":[2510.5,2330.6999999999998,2050.5999999999999,1783.3,1632.9000000000001,1513.0999999999999,1525.5999999999999,1653.0999999999999,1475,1567.8,1908.5,2587.5,2677,2309.5,2246.5999999999999,1807.2,1522.4000000000001,1444.4000000000001,1598.0999999999999,1669.2,1494.0999999999999,1649.0999999999999,1701,2120.1999999999998,2487.5999999999999,2242.4000000000001,2258.4000000000001,1881,1611.5,1591.4000000000001,1748.4000000000001,1725.7,1542.2,1645.9000000000001,1913.5999999999999,2378.9000000000001,2700.5,2500.3000000000002,2197.9000000000001,1743.5,1514.7,1368.4000000000001,1600.5,1651.5999999999999,1428.5999999999999,1553.2,1753.5999999999999,2263.6999999999998,2675.8000000000002,2511.0999999999999,2100.9000000000001,1745.2,1573,1483.7,1584.9000000000001,1578,1482.2,1557.2,1782.8,2327.6999999999998,2561.9000000000001,2243,2205.8000000000002,1724.9000000000001,1522.5999999999999,1534.0999999999999,1686.5999999999999,1695.0999999999999,1422.5,1428.2,1663.4000000000001,2326.4000000000001,2165.3000000000002,2144.4000000000001,2126.4000000000001,1681,1526.3,1550.9000000000001,1758.7,1751.7,1462.0999999999999,1644.2,1765.4000000000001,2122.8000000000002,2475.5999999999999,2567,2128.8000000000002,1810.0999999999999,1559.0999999999999,1555.2,1659.9000000000001,1896.0999999999999,1590.5,1627.8,1834.5,2399.1999999999998,2734,2503.4000000000001,2278.1999999999998,1823.9000000000001,1576.4000000000001,1604.2,1708.5999999999999,1682.9000000000001,1460.9000000000001,1635.8,1868.9000000000001,2399.6999999999998,2729.6999999999998,2332.5,2170.6999999999998,1741.3,1504,1527.8,1658,1736.5,1575,1666.5,1776.2,2491.9000000000001,2809.8000000000002,2481,2142.9000000000001,1691.8,1617.3,1649.5,1825.8,1878.9000000000001,1637.5,1664.9000000000001,1973.3,2714.0999999999999,2888.5999999999999,2452.4000000000001,2230.5,1825,1667.4000000000001,1657.3,1890.5,1891.8,1655.5999999999999,1744.5,2031.9000000000001,2541.9000000000001,2756.1999999999998,2500.6999999999998,2127.8000000000002,1953.0999999999999,1873.8,1868.4000000000001,2069.8000000000002,2008.8,1807.2,1901.0999999999999,2167.8000000000002,2503.9000000000001,2878.8000000000002,2567.1999999999998,2521.0999999999999,1967.5,1752.5,1742.9000000000001,1926.3,1927.4000000000001,1767,1866.8,2316.9000000000001,2920.8000000000002,3204.0999999999999,2741.1999999999998,2557.9000000000001,1961.7,1810.2,1745.4000000000001,1881,1933.0999999999999,1809.3,1912.8,2357.5,2679.1999999999998,3115,2925.1999999999998,2591.3000000000002,2007.9000000000001,1858.0999999999999,1899.9000000000001,2067.6999999999998,2052.6999999999998,1901.3,1987.3,2249.0999999999999,2588.1999999999998,3091.6999999999998,2652.3000000000002,2356.3000000000002,2083.8000000000002,1965.8,2000.7,2186.5999999999999,2208.4000000000001,1947.8,1925.2,2159.4000000000001,2866.3000000000002,2914.1999999999998,2340.5999999999999,2523.6999999999998,1932.5,1892.5,1910.9000000000001,2142.0999999999999,2094.3000000000002,1920.9000000000001,2032,2357.6999999999998,3084.5,3335,2705.9000000000001,2792.5999999999999,2346.3000000000002,2050.9000000000001,2058.6999999999998,2344.5999999999999,2307.6999999999998,2151.5,2279.0999999999999,2709.9000000000001,2993.0999999999999,3399.9000000000001,2999.1999999999998,2899.9000000000001,2201.0999999999999,2121,2115.1999999999998,2407.5,2437.1999999999998,2215.5999999999999,2472.3000000000002],"mode":"lines","line":{"color":"#00526d","width":2,"dash":[]},"type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-1-2">
<h4 id="features-engineering-data-wrangling">Features engineering | Data Wrangling</h4>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href=""></a>USgas_df <span class="ot">&lt;-</span> <span class="fu">ts_to_prophet</span>(USgas)</span>
<span id="cb4-2"><a href=""></a><span class="fu">head</span>(USgas_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          ds      y
1 2000-01-01 2510.5
2 2000-02-01 2330.7
3 2000-03-01 2050.6
4 2000-04-01 1783.3
5 2000-05-01 1632.9
6 2000-06-01 1513.1</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href=""></a>USgas_df<span class="sc">$</span>trend <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(USgas_df)</span>
<span id="cb6-2"><a href=""></a>USgas_df<span class="sc">$</span>seasonal <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">month</span>(USgas_df<span class="sc">$</span>ds, <span class="at">label =</span> T), <span class="at">ordered =</span> <span class="cn">FALSE</span>)</span>
<span id="cb6-3"><a href=""></a><span class="fu">head</span>(USgas_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          ds      y trend seasonal
1 2000-01-01 2510.5     1      Jan
2 2000-02-01 2330.7     2      Feb
3 2000-03-01 2050.6     3      Mar
4 2000-04-01 1783.3     4      Apr
5 2000-05-01 1632.9     5      May
6 2000-06-01 1513.1     6      Jun</code></pre>
</div>
</div>
</div>
<div id="tabset-1-3">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href=""></a>modelo <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> seasonal <span class="sc">+</span> trend <span class="sc">+</span> <span class="fu">I</span>(trend<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> USgas_df)</span>
<span id="cb8-2"><a href=""></a><span class="fu">summary</span>(modelo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ seasonal + trend + I(trend^2), data = USgas_df)

Residuals:
    Min      1Q  Median      3Q     Max 
-473.54  -55.44   -0.79   63.31  285.69 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  2.648e+03  3.166e+01  83.653  &lt; 2e-16 ***
seasonalFeb -3.058e+02  3.476e+01  -8.799 3.77e-16 ***
seasonalMar -4.857e+02  3.476e+01 -13.974  &lt; 2e-16 ***
seasonalApr -9.283e+02  3.476e+01 -26.709  &lt; 2e-16 ***
seasonalMay -1.109e+03  3.476e+01 -31.912  &lt; 2e-16 ***
seasonalJun -1.129e+03  3.476e+01 -32.469  &lt; 2e-16 ***
seasonalJul -9.591e+02  3.476e+01 -27.591  &lt; 2e-16 ***
seasonalAug -9.366e+02  3.476e+01 -26.943  &lt; 2e-16 ***
seasonalSep -1.141e+03  3.477e+01 -32.829  &lt; 2e-16 ***
seasonalOct -1.044e+03  3.477e+01 -30.017  &lt; 2e-16 ***
seasonalNov -7.927e+02  3.522e+01 -22.507  &lt; 2e-16 ***
seasonalDec -2.683e+02  3.522e+01  -7.618 7.18e-13 ***
trend       -1.560e+00  4.168e-01  -3.743 0.000231 ***
I(trend^2)   1.869e-02  1.689e-03  11.063  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 109.9 on 224 degrees of freedom
Multiple R-squared:  0.9412,    Adjusted R-squared:  0.9377 
F-statistic: 275.6 on 13 and 224 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</div>
<div id="tabset-1-4">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href=""></a>USgas_df<span class="sc">$</span>yhat <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo, <span class="at">newdata =</span> USgas_df)</span>
<span id="cb10-2"><a href=""></a></span>
<span id="cb10-3"><a href=""></a><span class="fu">ggplot</span>(USgas_df) <span class="sc">+</span></span>
<span id="cb10-4"><a href=""></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> ds, <span class="at">y =</span> y), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb10-5"><a href=""></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> ds, <span class="at">y =</span> yhat), <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb10-6"><a href=""></a>  <span class="fu">ylab</span>(<span class="st">"Billion Cubic Feet"</span>) <span class="sc">+</span></span>
<span id="cb10-7"><a href=""></a>  <span class="fu">xlab</span>(<span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb10-8"><a href=""></a>  <span class="fu">ggtitle</span>(<span class="st">"Observed and fitted USgas values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Aula06_files/figure-revealjs/unnamed-chunk-6-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-5">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href=""></a><span class="fu">library</span>(forecast)</span>
<span id="cb11-2"><a href=""></a>modelo_tslm <span class="ot">&lt;-</span> <span class="fu">tslm</span>(USgas <span class="sc">~</span> season <span class="sc">+</span> trend <span class="sc">+</span> <span class="fu">I</span>(trend<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb11-3"><a href=""></a><span class="fu">summary</span>(modelo_tslm)    </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
tslm(formula = USgas ~ season + trend + I(trend^2))

Residuals:
    Min      1Q  Median      3Q     Max 
-473.54  -55.44   -0.79   63.31  285.69 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  2.648e+03  3.166e+01  83.653  &lt; 2e-16 ***
season2     -3.058e+02  3.476e+01  -8.799 3.77e-16 ***
season3     -4.857e+02  3.476e+01 -13.974  &lt; 2e-16 ***
season4     -9.283e+02  3.476e+01 -26.709  &lt; 2e-16 ***
season5     -1.109e+03  3.476e+01 -31.912  &lt; 2e-16 ***
season6     -1.129e+03  3.476e+01 -32.469  &lt; 2e-16 ***
season7     -9.591e+02  3.476e+01 -27.591  &lt; 2e-16 ***
season8     -9.366e+02  3.476e+01 -26.943  &lt; 2e-16 ***
season9     -1.141e+03  3.477e+01 -32.829  &lt; 2e-16 ***
season10    -1.044e+03  3.477e+01 -30.017  &lt; 2e-16 ***
season11    -7.927e+02  3.522e+01 -22.507  &lt; 2e-16 ***
season12    -2.683e+02  3.522e+01  -7.618 7.18e-13 ***
trend       -1.560e+00  4.168e-01  -3.743 0.000231 ***
I(trend^2)   1.869e-02  1.689e-03  11.063  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 109.9 on 224 degrees of freedom
Multiple R-squared:  0.9412,    Adjusted R-squared:  0.9377 
F-statistic: 275.6 on 13 and 224 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="tendência-sazonalidade-4" class="slide level2">
<h2>Tendência + Sazonalidade</h2>
<h4>
Produção trimestral de cerveja na Australia
</h4>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href=""></a><span class="fu">library</span>(fpp3)</span>
<span id="cb13-2"><a href=""></a><span class="fu">library</span>(dplyr)</span>
<span id="cb13-3"><a href=""></a>aus_production <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">year</span>(Quarter) <span class="sc">&gt;=</span> <span class="dv">1992</span>) <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(Beer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="Aula06_files/figure-revealjs/unnamed-chunk-8-1.png" class="quarto-figure quarto-figure-center r-stretch" width="1440"><p>Contruiremos um modelo da forma <span class="math display">\[Beer_t = \beta_0 + \beta_1 t + \beta_2 D_{2,t} + \beta_3 D_{3,t} + \beta_4 D_{4,t} + \epsilon_t,\]</span> em que <span class="math inline">\(D_{i,t} = 1\)</span> se <span class="math inline">\(t \in\)</span> Trimestre <span class="math inline">\(i\)</span> e 0, caso contrário.</p>
</section>
<section id="tendência-sazonalidade-5" class="slide level2">
<h2>Tendência + Sazonalidade</h2>
<div class="panel-tabset">
<ul id="tabset-2" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-2-1">Modelos</a></li><li><a href="#tabset-2-2">Resultado Modelo 1</a></li><li><a href="#tabset-2-3">Resultado Modelo 2</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href=""></a>modelo_dummy <span class="ot">&lt;-</span> aus_production <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">year</span>(Quarter) <span class="sc">&gt;=</span> <span class="dv">1992</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href=""></a>  <span class="fu">model</span>(<span class="fu">TSLM</span>(Beer <span class="sc">~</span> <span class="fu">trend</span>() <span class="sc">+</span> <span class="fu">season</span>())) </span>
<span id="cb14-3"><a href=""></a>modelo_fourier <span class="ot">&lt;-</span> aus_production <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">year</span>(Quarter) <span class="sc">&gt;=</span> <span class="dv">1992</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-4"><a href=""></a>  <span class="fu">model</span>(<span class="fu">TSLM</span>(Beer <span class="sc">~</span> <span class="fu">trend</span>() <span class="sc">+</span> <span class="fu">fourier</span>(<span class="at">K =</span> <span class="dv">2</span>))) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-2-2">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href=""></a><span class="fu">report</span>(modelo_dummy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: Beer 
Model: TSLM 

Residuals:
     Min       1Q   Median       3Q      Max 
-42.9029  -7.5995  -0.4594   7.9908  21.7895 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   441.80044    3.73353 118.333  &lt; 2e-16 ***
trend()        -0.34027    0.06657  -5.111 2.73e-06 ***
season()year2 -34.65973    3.96832  -8.734 9.10e-13 ***
season()year3 -17.82164    4.02249  -4.430 3.45e-05 ***
season()year4  72.79641    4.02305  18.095  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 12.23 on 69 degrees of freedom
Multiple R-squared: 0.9243, Adjusted R-squared: 0.9199
F-statistic: 210.7 on 4 and 69 DF, p-value: &lt; 2.22e-16</code></pre>
</div>
</div>
</div>
<div id="tabset-2-3">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href=""></a><span class="fu">report</span>(modelo_fourier)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: Beer 
Model: TSLM 

Residuals:
     Min       1Q   Median       3Q      Max 
-42.9029  -7.5995  -0.4594   7.9908  21.7895 

Coefficients:
                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)        446.87920    2.87321 155.533  &lt; 2e-16 ***
trend()             -0.34027    0.06657  -5.111 2.73e-06 ***
fourier(K = 2)C1_4   8.91082    2.01125   4.430 3.45e-05 ***
fourier(K = 2)S1_4 -53.72807    2.01125 -26.714  &lt; 2e-16 ***
fourier(K = 2)C2_4 -13.98958    1.42256  -9.834 9.26e-15 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 12.23 on 69 degrees of freedom
Multiple R-squared: 0.9243, Adjusted R-squared: 0.9199
F-statistic: 210.7 on 4 and 69 DF, p-value: &lt; 2.22e-16</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="tendência-sazonalidade-dummy" class="slide level2">
<h2>Tendência + Sazonalidade: Dummy</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href=""></a><span class="fu">augment</span>(modelo_dummy) <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href=""></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Quarter)) <span class="sc">+</span></span>
<span id="cb19-3"><a href=""></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Beer, <span class="at">colour =</span> <span class="st">"Data"</span>)) <span class="sc">+</span></span>
<span id="cb19-4"><a href=""></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> .fitted, <span class="at">colour =</span> <span class="st">"Fitted"</span>)) <span class="sc">+</span></span>
<span id="cb19-5"><a href=""></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="at">Data =</span> <span class="st">"black"</span>, <span class="at">Fitted =</span> <span class="st">"red"</span>)) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Megalitros"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Trimestre"</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Produção trimestral de cerveja australiana"</span>) <span class="sc">+</span> </span>
<span id="cb19-6"><a href=""></a>   <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Séries"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="Aula06_files/figure-revealjs/unnamed-chunk-12-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="tendência-sazonalidade-fourier" class="slide level2">
<h2>Tendência + Sazonalidade: Fourier</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href=""></a><span class="fu">augment</span>(modelo_fourier) <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href=""></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Quarter)) <span class="sc">+</span></span>
<span id="cb20-3"><a href=""></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Beer, <span class="at">colour =</span> <span class="st">"Data"</span>)) <span class="sc">+</span></span>
<span id="cb20-4"><a href=""></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> .fitted, <span class="at">colour =</span> <span class="st">"Fitted"</span>)) <span class="sc">+</span></span>
<span id="cb20-5"><a href=""></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="at">Data =</span> <span class="st">"black"</span>, <span class="at">Fitted =</span> <span class="st">"blue"</span>)) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Megalitros"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Trimestre"</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Produção trimestral de cerveja australiana"</span>) <span class="sc">+</span> </span>
<span id="cb20-6"><a href=""></a>   <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Séries"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="Aula06_files/figure-revealjs/unnamed-chunk-13-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="tendência-sazonalidade-diagnóstico" class="slide level2">
<h2>Tendência + Sazonalidade: Diagnóstico</h2>
<div class="panel-tabset">
<ul id="tabset-3" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-3-1">Dummy I</a></li><li><a href="#tabset-3-2">Dummy II</a></li><li><a href="#tabset-3-3">Dummy III</a></li><li><a href="#tabset-3-4">Fourier I</a></li><li><a href="#tabset-3-5">Fourier II</a></li><li><a href="#tabset-3-6">Fourier III</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href=""></a>modelo_dummy <span class="sc">%&gt;%</span> <span class="fu">gg_tsresiduals</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Aula06_files/figure-revealjs/unnamed-chunk-14-1.png" class="quarto-figure quarto-figure-center" width="1440"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-2">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href=""></a><span class="fu">tidy</span>(modelo_dummy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 6
  .model                          term     estimate std.error statistic  p.value
  &lt;chr&gt;                           &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 TSLM(Beer ~ trend() + season()) (Interc…  442.       3.73      118.   2.02e-81
2 TSLM(Beer ~ trend() + season()) trend()    -0.340    0.0666     -5.11 2.73e- 6
3 TSLM(Beer ~ trend() + season()) season(…  -34.7      3.97       -8.73 9.10e-13
4 TSLM(Beer ~ trend() + season()) season(…  -17.8      4.02       -4.43 3.45e- 5
5 TSLM(Beer ~ trend() + season()) season(…   72.8      4.02       18.1  6.68e-28</code></pre>
</div>
</div>
</div>
<div id="tabset-3-3">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href=""></a><span class="fu">augment</span>(modelo_dummy) <span class="sc">|&gt;</span> <span class="fu">features</span>(.innov, box_pierce, <span class="at">lag =</span> <span class="dv">8</span>, <span class="at">dof =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  .model                          bp_stat bp_pvalue
  &lt;chr&gt;                             &lt;dbl&gt;     &lt;dbl&gt;
1 TSLM(Beer ~ trend() + season())    9.53    0.0230</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href=""></a><span class="fu">augment</span>(modelo_dummy) <span class="sc">|&gt;</span> <span class="fu">features</span>(.innov, ljung_box, <span class="at">lag =</span> <span class="dv">8</span>, <span class="at">dof =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  .model                          lb_stat lb_pvalue
  &lt;chr&gt;                             &lt;dbl&gt;     &lt;dbl&gt;
1 TSLM(Beer ~ trend() + season())    10.4    0.0157</code></pre>
</div>
</div>
</div>
<div id="tabset-3-4">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href=""></a>modelo_fourier <span class="sc">%&gt;%</span> <span class="fu">gg_tsresiduals</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Aula06_files/figure-revealjs/unnamed-chunk-17-1.png" class="quarto-figure quarto-figure-center" width="1440"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-5">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href=""></a><span class="fu">tidy</span>(modelo_fourier)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 6
  .model                             term  estimate std.error statistic  p.value
  &lt;chr&gt;                              &lt;chr&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 TSLM(Beer ~ trend() + fourier(K =… (Int…  447.       2.87      156.   1.39e-89
2 TSLM(Beer ~ trend() + fourier(K =… tren…   -0.340    0.0666     -5.11 2.73e- 6
3 TSLM(Beer ~ trend() + fourier(K =… four…    8.91     2.01        4.43 3.45e- 5
4 TSLM(Beer ~ trend() + fourier(K =… four…  -53.7      2.01      -26.7  4.10e-38
5 TSLM(Beer ~ trend() + fourier(K =… four…  -14.0      1.42       -9.83 9.26e-15</code></pre>
</div>
</div>
</div>
<div id="tabset-3-6">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href=""></a><span class="fu">augment</span>(modelo_fourier) <span class="sc">|&gt;</span> <span class="fu">features</span>(.innov, box_pierce, <span class="at">lag =</span> <span class="dv">8</span>, <span class="at">dof =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  .model                                bp_stat bp_pvalue
  &lt;chr&gt;                                   &lt;dbl&gt;     &lt;dbl&gt;
1 TSLM(Beer ~ trend() + fourier(K = 2))    9.53    0.0230</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href=""></a><span class="fu">augment</span>(modelo_fourier) <span class="sc">|&gt;</span> <span class="fu">features</span>(.innov, ljung_box, <span class="at">lag =</span> <span class="dv">8</span>, <span class="at">dof =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  .model                                lb_stat lb_pvalue
  &lt;chr&gt;                                   &lt;dbl&gt;     &lt;dbl&gt;
1 TSLM(Beer ~ trend() + fourier(K = 2))    10.4    0.0157</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="tendência-sazonalidade-diagnóstico-1" class="slide level2">
<h2>Tendência + Sazonalidade: Diagnóstico</h2>
<p>O <code>K = m/2</code> em <code>fourier()</code> especifica quantos pares de <span class="math inline">\(\sin()\)</span> e <span class="math inline">\(\cos()\)</span> utilizaremos na regressão. Como utilizamos o máximo (<span class="math inline">\(m = 4 \rightarrow K = 2\)</span>), teremos exatamente os mesmos <span class="math inline">\(\hat{y}\)</span></p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href=""></a><span class="fu">head</span>(<span class="fu">cbind</span>(<span class="fu">augment</span>(modelo_fourier)<span class="sc">$</span>.fitted, <span class="fu">augment</span>(modelo_dummy)<span class="sc">$</span>.fitted))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         [,1]     [,2]
[1,] 441.4602 441.4602
[2,] 406.4602 406.4602
[3,] 422.9580 422.9580
[4,] 513.2358 513.2358
[5,] 440.0991 440.0991
[6,] 405.0991 405.0991</code></pre>
</div>
</div>
<ul>
<li class="fragment">Teste utilizando <span class="math inline">\(K = 1\)</span>.</li>
<li class="fragment">Quando <span class="math inline">\(m\)</span> for grande, utilizar variáveis de Fourier é mais utilizado.</li>
<li class="fragment">Quando <span class="math inline">\(m\)</span> for pequeno, não há muitos ganhos em utilizar variáveis de Fourier.</li>
</ul>
</section></section>
<section>
<section id="previsão" class="title-slide slide level1 center">
<h1>Previsão</h1>

</section>
<section id="previsão-1" class="slide level2">
<h2>Previsão</h2>
<center>
<img data-src="imagens/forecast.jpg">
</center>
<ul>
<li class="fragment">Temos visto como usar modelos de regressão em um contexto de séries temporias, mas nada foi dito sobre como fazer previsão <span class="math inline">\(h\)</span> passos à frente.</li>
<li class="fragment">Sabemos que, com os <span class="math inline">\(\hat{\beta}s\)</span>, podemos obter os valores estimados <span class="math inline">\(\hat{y}_t\)</span> ( <span class="math inline">\(t = 1, \ldots, T\)</span>) através da equação <span class="math display">\[\hat{y}_t = \hat{\beta}_0 + \hat{\beta}_1 x_{1,t} + \cdots + \hat{\beta}_k x_{k,t}.\]</span></li>
</ul>
</section>
<section id="previsão-2" class="slide level2">
<h2>Previsão</h2>
<p><strong>Mas, como fazer se estamos interessados em <span class="math inline">\(\hat{y}_{T+1|T}, \cdots, \hat{y}_{T+h|T}\)</span>?</strong></p>
<div class="fragment">
<p>Em geral, quando trabalhamos com modelos da forma <span class="math display">\[y_t = \beta_0 + \beta_1 x_{1,t} + \cdots + \beta_k x_{k,t} + e_t\]</span> nunca conhecemos os valores de <span class="math inline">\(x_1, x_2, ..., x_k\)</span> no futuro, <strong>exceto quando <span class="math inline">\(x_i\)</span> é deterministico!.</strong></p>
</div>
<div class="fragment">
<p>Pense no modelo <span class="math display">\[y_t = \beta_0 + \beta_1 x_{1,t} + \cdots + \beta_k x_{k,t} + e_t\]</span> em que <span class="math inline">\(x_1 = t\)</span>, <span class="math inline">\(x_2 = t^2\)</span>, <span class="math inline">\(x_3 = D_{Fevereiro}\)</span>, <span class="math inline">\(x_4 = D_{Março}\)</span>, …. <span class="math inline">\(x_k = D_{Dezembro}\)</span>.</p>
</div>
<div class="fragment">
<p>Basta obter <span class="math inline">\(\hat{\beta}\)</span> (utilizando a informação disponível até o tempo <span class="math inline">\(T\)</span>), utilizar os valores futuros das variáveis explicativas ( <span class="math inline">\(x_{1, T + h}, \ldots, x_{k, T + h}\)</span> ) e fazer a previsão!.</p>
</div>
</section>
<section id="previsão-3" class="slide level2">
<h2>Previsão</h2>
<p>Utilizando o <em>dataset</em> <code>aus_production</code> do pacote <code>fpp3</code>, faremos a previsão <span class="math inline">\(h = 12\)</span> passos à frente da produção de cerveja (<code>Beer</code>) na Austrália.</p>
<div class="panel-tabset">
<ul id="tabset-4" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-4-1">Dados</a></li><li><a href="#tabset-4-2">Modelo</a></li><li><a href="#tabset-4-3">Previsão</a></li><li><a href="#tabset-4-4">Gráfico</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href=""></a><span class="fu">library</span>(fpp3)</span>
<span id="cb37-2"><a href=""></a>beer <span class="ot">&lt;-</span> aus_production <span class="sc">|&gt;</span> </span>
<span id="cb37-3"><a href=""></a>  <span class="fu">select</span>(Quarter, Beer) <span class="sc">|&gt;</span> </span>
<span id="cb37-4"><a href=""></a>  <span class="fu">filter</span>(<span class="fu">year</span>(Quarter) <span class="sc">&gt;</span> <span class="dv">1992</span>)</span>
<span id="cb37-5"><a href=""></a><span class="fu">autoplot</span>(beer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Aula06_files/figure-revealjs/unnamed-chunk-21-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-2">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href=""></a>fit_beer <span class="ot">&lt;-</span> beer <span class="sc">%&gt;%</span> <span class="fu">model</span>(<span class="fu">TSLM</span>(Beer <span class="sc">~</span> <span class="fu">trend</span>() <span class="sc">+</span> <span class="fu">season</span>()))</span>
<span id="cb38-2"><a href=""></a><span class="fu">report</span>(fit_beer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: Beer 
Model: TSLM 

Residuals:
     Min       1Q   Median       3Q      Max 
-42.1193  -7.7552  -0.5074   7.7665  22.3373 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   439.41993    3.87255 113.471  &lt; 2e-16 ***
trend()        -0.31359    0.07303  -4.294 5.98e-05 ***
season()year2 -34.79753    4.11473  -8.457 4.51e-12 ***
season()year3 -17.56209    4.17414  -4.207 8.09e-05 ***
season()year4  71.75149    4.17478  17.187  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 12.34 on 65 degrees of freedom
Multiple R-squared: 0.9213, Adjusted R-squared: 0.9164
F-statistic: 190.1 on 4 and 65 DF, p-value: &lt; 2.22e-16</code></pre>
</div>
</div>
</div>
<div id="tabset-4-3">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href=""></a>fore_beer <span class="ot">&lt;-</span> fit_beer <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">12</span>)</span>
<span id="cb40-2"><a href=""></a>fore_beer</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A fable: 12 x 4 [1Q]
# Key:     .model [1]
   .model                          Quarter
   &lt;chr&gt;                             &lt;qtr&gt;
 1 TSLM(Beer ~ trend() + season()) 2010 Q3
 2 TSLM(Beer ~ trend() + season()) 2010 Q4
 3 TSLM(Beer ~ trend() + season()) 2011 Q1
 4 TSLM(Beer ~ trend() + season()) 2011 Q2
 5 TSLM(Beer ~ trend() + season()) 2011 Q3
 6 TSLM(Beer ~ trend() + season()) 2011 Q4
 7 TSLM(Beer ~ trend() + season()) 2012 Q1
 8 TSLM(Beer ~ trend() + season()) 2012 Q2
 9 TSLM(Beer ~ trend() + season()) 2012 Q3
10 TSLM(Beer ~ trend() + season()) 2012 Q4
11 TSLM(Beer ~ trend() + season()) 2013 Q1
12 TSLM(Beer ~ trend() + season()) 2013 Q2
# ℹ 2 more variables: Beer &lt;dist&gt;, .mean &lt;dbl&gt;</code></pre>
</div>
</div>
</div>
<div id="tabset-4-4">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href=""></a>fore_beer <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(beer) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Aula06_files/figure-revealjs/unnamed-chunk-24-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="previsão-5" class="slide level2">
<h2>Previsão</h2>
<p>No exemplo anterior, vimos que fazer previsão quando as variáveis explicativas são determinísticas resume-se a:</p>
<ul>
<li class="fragment">Obter <span class="math inline">\(\hat{\beta}\)</span>,</li>
<li class="fragment">Utilizar os valores das variáveis explicativas (<span class="math inline">\(x_i\)</span>) no futuro (como as variáveis são determinísticas sempre temos esses valores!),</li>
<li class="fragment">Utilizar o modelo e obter <span class="math inline">\(\hat{y}_{T+h|T}\)</span>.</li>
</ul>
<div class="fragment">
<blockquote>
<p>Contudo, <strong>muito raramente</strong> o modelo terá <strong>apenas</strong> variáveis determinísticas!. Na prática, o modelo terá variaveis explicativas <span class="math inline">\(x_{k+1}, \ldots, x_{k+p}\)</span> cujos valores no tempo <span class="math inline">\(T+h\)</span> não são conhecidos no tempo <span class="math inline">\(T\)</span> 😱.</p>
</blockquote>
</div>
</section>
<section id="previsão-6" class="slide level2">
<h2>Previsão</h2>
<p>O modelo que estou utilizando tem variáveis que não são determinísticas, e agora?</p>
<center>
<img data-src="imagens/koala_medo.png">
</center>
<div class="fragment">
<ul>
<li class="fragment">Utilizar previsões das variáveis preditoras utilizadas no modelo.</li>
<li class="fragment">Trabalhar com cenários.</li>
</ul>
</div>
</section>
<section id="previsão-7" class="slide level2">
<h2>Previsão</h2>
<p>Assumimos diferentes cenários para as variáveis explicativas no modelo:</p>
<ul>
<li class="fragment">Se o IPCA aumetar, em média 0.8% nos próximos meses, o volume de vendas nas festas de final de ano será de…</li>
<li class="fragment">Se até final do ano o PIB aumentar em x%, a previsão da taxa de desempregados no Brasil será de …..</li>
<li class="fragment">Se o número de vacinados contra a COVID-19 no Brasil aumentar em x%, a receita com turismo interno no Brasil será de ….</li>
</ul>
<div class="fragment">
<blockquote>
<p>Em todos os casos temos apenas cenários, não há garantia que isso acontecerá mas, se acotecer, temos um valor esperado de como irá se comportar o fenômeno de interesse ao longo do tempo.</p>
</blockquote>
</div>
</section>
<section id="previsão-8" class="slide level2">
<h2>Previsão</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href=""></a>modelo <span class="ot">&lt;-</span> us_change <span class="sc">%&gt;%</span> <span class="fu">model</span>(<span class="at">lm =</span> <span class="fu">TSLM</span>(Consumption <span class="sc">~</span> Income <span class="sc">+</span> Savings <span class="sc">+</span> Unemployment))</span>
<span id="cb43-2"><a href=""></a><span class="co"># Criando os cenários</span></span>
<span id="cb43-3"><a href=""></a>cenarios <span class="ot">&lt;-</span> <span class="fu">scenarios</span>(</span>
<span id="cb43-4"><a href=""></a>  <span class="at">caso1 =</span> <span class="fu">new_data</span>(us_change, <span class="dv">4</span>) <span class="sc">|&gt;</span>  <span class="co"># pega o dataset e cria 4 novas observacoes</span></span>
<span id="cb43-5"><a href=""></a>            <span class="fu">mutate</span>(<span class="at">Income =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.1</span>, <span class="fl">1.2</span>, <span class="fl">1.3</span>),           <span class="co"># Criando cenário para Income </span></span>
<span id="cb43-6"><a href=""></a>                   <span class="at">Savings =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.52</span>, <span class="fl">0.54</span>, <span class="fl">0.56</span>),     <span class="co"># Criando cenário para Savings </span></span>
<span id="cb43-7"><a href=""></a>                   <span class="at">Unemployment =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>, <span class="fl">0.10</span>, <span class="fl">0.15</span>)), <span class="co"># Criando cenário para Unemployment </span></span>
<span id="cb43-8"><a href=""></a>  <span class="at">caso2 =</span> <span class="fu">new_data</span>(us_change, <span class="dv">4</span>) <span class="sc">|&gt;</span>  <span class="co"># pega o dataset e cria 4 novas observacoes</span></span>
<span id="cb43-9"><a href=""></a>            <span class="fu">mutate</span>(<span class="at">Income =</span> <span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.1</span>, <span class="fl">1.2</span>, <span class="fl">1.3</span>),           <span class="co"># Criando cenário para Income </span></span>
<span id="cb43-10"><a href=""></a>                   <span class="at">Savings =</span> <span class="sc">-</span><span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.52</span>, <span class="fl">0.54</span>, <span class="fl">0.56</span>),    <span class="co"># Criando cenário para Savings </span></span>
<span id="cb43-11"><a href=""></a>                   <span class="at">Unemployment =</span> <span class="sc">-</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>, <span class="fl">0.10</span>, <span class="fl">0.15</span>)))</span>
<span id="cb43-12"><a href=""></a>fc <span class="ot">&lt;-</span> <span class="fu">forecast</span>(modelo, <span class="at">new_data =</span> cenarios)</span>
<span id="cb43-13"><a href=""></a>fc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A fable: 8 x 8 [1Q]
# Key:     .scenario, .model [2]
  .scenario .model Quarter
  &lt;chr&gt;     &lt;chr&gt;    &lt;qtr&gt;
1 caso1     lm     2019 Q3
2 caso1     lm     2019 Q4
3 caso1     lm     2020 Q1
4 caso1     lm     2020 Q2
5 caso2     lm     2019 Q3
6 caso2     lm     2019 Q4
7 caso2     lm     2020 Q1
8 caso2     lm     2020 Q2
# ℹ 5 more variables: Consumption &lt;dist&gt;, .mean &lt;dbl&gt;, Income &lt;dbl&gt;,
#   Savings &lt;dbl&gt;, Unemployment &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="previsão-9" class="slide level2">
<h2>Previsão</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href=""></a>us_change <span class="sc">%&gt;%</span></span>
<span id="cb45-2"><a href=""></a>  <span class="fu">autoplot</span>(Consumption) <span class="sc">+</span></span>
<span id="cb45-3"><a href=""></a>  <span class="fu">autolayer</span>(fc) <span class="sc">+</span></span>
<span id="cb45-4"><a href=""></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"US consumption"</span>, <span class="at">y =</span> <span class="st">"Variação percetual"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="Aula06_files/figure-revealjs/unnamed-chunk-26-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="previsão-10" class="slide level2">
<h2>Previsão</h2>
<p>O que foi feito?</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 6
  .model term         estimate std.error statistic  p.value
  &lt;chr&gt;  &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 lm     (Intercept)    0.266    0.0341       7.81 3.57e-13
2 lm     Income         0.757    0.0396      19.1  1.91e-46
3 lm     Savings       -0.0537   0.00292    -18.4  2.55e-44
4 lm     Unemployment  -0.313    0.0678      -4.62 7.06e- 6</code></pre>
</div>
</div>
<p><span class="math display">\[\widehat{\text{Consumption}}_{T+h} = 0.266 + 0.757 \text{Income}_{T+h} -0.0537 \text{Savings}_{T+h} -0.313 \text{Unemployment}_{T+h}\]</span></p>
<p>Quando construimos cenários, estamos definindo valores hipotéticos para os diferentes valores de <span class="math inline">\(\text{Income}_{T+h}\)</span>, <span class="math inline">\(\text{Savings}_{T+h}\)</span> e <span class="math inline">\(\text{Unemployment}_{T+h}\)</span>. Assim, basta substituir esse valores na Equação e pronto!.</p>
</section></section>
<section>
<section id="não-lineariedades" class="title-slide slide level1 center">
<h1>Não lineariedades</h1>

</section>
<section id="não-lineariedades-1" class="slide level2">
<h2>Não lineariedades</h2>
<p>Sabemos que existem várias formas de incluir não lineariedades nos modelos de regressão:</p>
<ul>
<li class="fragment">Aplicar <span class="math inline">\(\log()\)</span>.</li>
<li class="fragment">Incluir variáveis ao quadrado (ou cubo).</li>
<li class="fragment">Efeitos de interação.</li>
</ul>
<div class="fragment">
<blockquote>
<p>Todas essas técnicas continuam sendo válidas quando trabalhamos com modelos de regressão em um contexto de séries temporais. <strong>Contudo, existem também outras formas de lidar com a não lineariedade.</strong></p>
</blockquote>
</div>
</section>
<section id="não-lineariedades-2" class="slide level2">
<h2>Não lineariedades</h2>
<p>Em geral, queremos modelos da forma <span class="math inline">\(y = f(x) + e\)</span></p>
<div class="fragment">
<p>Em lugar de termos <span class="math inline">\(f(x) = \beta_0 + \beta_1 x\)</span>, podemos fazer <span class="math inline">\(f()\)</span> linear por partes. Ou seja, incluimos pontos (que chamaremos de <strong>knots</strong> ou <strong>nós</strong>) nos quais a pendente de <span class="math inline">\(f()\)</span> pode mudar. Isto pode ser feito fazendo</p>
<center>
<ul>
<li class="fragment"><span class="math inline">\(x_1 = x\)</span>,</li>
<li class="fragment"><span class="math inline">\(x_2 = (x - c)_{+} = \begin{cases}
        0 &amp;  x &lt; c \\
        x - c &amp; x \geq c
     \end{cases}\)</span></li>
</ul>
</center>
</div>
<div class="fragment">
<p>Em geral, podemos fazer:</p>
<p><span class="math display">\[x_1 = x, \quad x_2 = (x - c_1)_{+}, \quad, \cdots, x_k = (x-c_k)_{+}.\]</span></p>
<p>Um modelo de regressão dessa forma é chamado de regressão por <em>splines</em>.</p>
</div>
</section>
<section id="não-lineariedades-3" class="slide level2">
<h2>Não lineariedades</h2>
<div class="panel-tabset">
<ul id="tabset-5" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-5-1">Dados</a></li><li><a href="#tabset-5-2">EDA</a></li><li><a href="#tabset-5-3">EDA2</a></li><li><a href="#tabset-5-4">Modelagem</a></li><li><a href="#tabset-5-5">Gráfico</a></li><li><a href="#tabset-5-6">Obs</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1">
<p>O <em>dataset</em> <code>boston_marathon</code> do pacote <code>fpp3</code> contém informações sobre o tempo (em segundos) dos ganhadores da maratona ao longo dos anos de 5 categorias diferentes.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href=""></a>boston_men <span class="ot">&lt;-</span> boston_marathon <span class="sc">%&gt;%</span> </span>
<span id="cb47-2"><a href=""></a>  <span class="fu">filter</span>(Event <span class="sc">==</span> <span class="st">"Men's open division"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-3"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">Minutos =</span> <span class="fu">as.numeric</span>(Time)<span class="sc">/</span><span class="dv">60</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb47-4"><a href=""></a>  <span class="fu">select</span>(Year, Minutos)</span>
<span id="cb47-5"><a href=""></a><span class="fu">glimpse</span>(boston_men)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 123
Columns: 2
$ Year    &lt;int&gt; 1897, 1898, 1899, 1900, 1901, 1902, 1903, 1904, 1905, 1906, 19…
$ Minutos &lt;dbl&gt; 175.1667, 162.0000, 174.6333, 159.7333, 149.3833, 163.2000, 16…</code></pre>
</div>
</div>
</div>
<div id="tabset-5-2">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href=""></a><span class="fu">ggplot</span>(<span class="at">data =</span> boston_men) <span class="sc">+</span> </span>
<span id="cb49-2"><a href=""></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Minutos)) <span class="sc">+</span> </span>
<span id="cb49-3"><a href=""></a>  <span class="fu">ylab</span>(<span class="st">"Minutos"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Ano"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Aula06_files/figure-revealjs/unnamed-chunk-29-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-5-3">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href=""></a><span class="co"># Obs: O percurso da maratona foi modificado em 1924 (de 24.5 milhas para 26.2 milhas), consideraremos somente dados de 1924 em diante.</span></span>
<span id="cb50-2"><a href=""></a>boston_men <span class="ot">&lt;-</span> boston_men <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Year <span class="sc">&gt;=</span> <span class="dv">1924</span>)</span>
<span id="cb50-3"><a href=""></a><span class="fu">ggplot</span>(<span class="at">data =</span> boston_men) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Minutos)) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Minutos"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Ano"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Aula06_files/figure-revealjs/unnamed-chunk-30-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-5-4">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href=""></a>modelos <span class="ot">&lt;-</span> boston_men <span class="sc">%&gt;%</span></span>
<span id="cb51-2"><a href=""></a>  <span class="fu">model</span>(<span class="at">linear =</span> <span class="fu">TSLM</span>(Minutos <span class="sc">~</span> <span class="fu">trend</span>()),</span>
<span id="cb51-3"><a href=""></a>        <span class="at">exponencial =</span> <span class="fu">TSLM</span>(<span class="fu">log</span>(Minutos) <span class="sc">~</span> <span class="fu">trend</span>()),</span>
<span id="cb51-4"><a href=""></a>        <span class="at">spline =</span> <span class="fu">TSLM</span>(Minutos <span class="sc">~</span> <span class="fu">trend</span>(<span class="at">knots =</span> <span class="fu">c</span>(<span class="dv">1950</span>, <span class="dv">1980</span>))))</span>
<span id="cb51-5"><a href=""></a>previsoes <span class="ot">&lt;-</span> <span class="fu">forecast</span>(modelos, <span class="at">h =</span> <span class="dv">12</span>)</span>
<span id="cb51-6"><a href=""></a>previsoes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A fable: 36 x 4 [1Y]
# Key:     .model [3]
   .model  Year
   &lt;chr&gt;  &lt;dbl&gt;
 1 linear  2020
 2 linear  2021
 3 linear  2022
 4 linear  2023
 5 linear  2024
 6 linear  2025
 7 linear  2026
 8 linear  2027
 9 linear  2028
10 linear  2029
# ℹ 26 more rows
# ℹ 2 more variables: Minutos &lt;dist&gt;, .mean &lt;dbl&gt;</code></pre>
</div>
</div>
</div>
<div id="tabset-5-5">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href=""></a>boston_men <span class="sc">%&gt;%</span></span>
<span id="cb53-2"><a href=""></a>  <span class="fu">autoplot</span>(Minutos) <span class="sc">+</span></span>
<span id="cb53-3"><a href=""></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> <span class="fu">fitted</span>(modelos),</span>
<span id="cb53-4"><a href=""></a>            <span class="fu">aes</span>(<span class="at">y =</span> .fitted, <span class="at">colour =</span> .model)) <span class="sc">+</span></span>
<span id="cb53-5"><a href=""></a>  <span class="fu">autolayer</span>(previsoes) <span class="sc">+</span></span>
<span id="cb53-6"><a href=""></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Minutos"</span>, <span class="at">x =</span> <span class="st">"Ano"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Aula06_files/figure-revealjs/unnamed-chunk-32-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-5-6">
<p>Quando trabalhamos com um modelo com splines, podemos passar no argumento <code>knots</code> tanto as posições exatas dos nós, quanto o número de nós. Nesse último caso, a posição do nó será calculada automaticamente.</p>
<blockquote>
<p>Procedimentos automáticos ajudam, mas não estão isentos de erro.</p>
</blockquote>
</div>
</div>
</div>
</section></section>
<section>
<section id="comentários-finais" class="title-slide slide level1 center">
<h1>Comentários finais</h1>

</section>
<section id="comentários-finais-1" class="slide level2">
<h2>Comentários finais</h2>
<ul>
<li class="fragment">Quando temos muitos preditores, é commum querermos selecionar apenas alguns (os melhores). Para isto, considere o seguinte:
<ul>
<li class="fragment">Evite escolher o preditor apenas do gráfico de dispersão vs.&nbsp;preditor (não sempre é possível ver esta relação)</li>
<li class="fragment">Evite escolher apenas pelo <span class="math inline">\(p-valor\)</span> (se tivermos variáveis correlacionadas, o <span class="math inline">\(p-valor\)</span> pode ser enganoso).</li>
<li class="fragment">Escolha segundo algumas medidas de desempenho (AIC, AICc, CV).</li>
<li class="fragment">Stepwise.</li>
<li class="fragment">Regularização.</li>
</ul></li>
</ul>
</section>
<section id="comentários-finais-2" class="slide level2">
<h2>Comentários finais</h2>
<div class="columns">
<div class="column" style="width:50%;">
<h4 id="previsão-ex-ante">Previsão ex-ante</h4>
<ul>
<li class="fragment">Ex-ante: antes do evento.</li>
<li class="fragment">Utilizando a informação disponível até o tempo <span class="math inline">\(T\)</span>, fazer previsão para o tempo <span class="math inline">\(T+h\)</span> (fazemos a previsão para <span class="math inline">\(T+h\)</span> antes de <span class="math inline">\(T+h\)</span> acontecer)</li>
</ul>
</div><div class="column" style="width:50%;">
<h4 id="previsão-ex-post">Previsão ex-post</h4>
<ul>
<li class="fragment">Ex-post: depois do evento.</li>
<li class="fragment">Utilizando informação disponível até o tempo <span class="math inline">\(T\)</span>, fazer “previsão” para o tempo <span class="math inline">\(t\)</span> ( <span class="math inline">\(t &lt; T\)</span>).</li>
</ul>
</div></div>
</section>
<section id="referências" class="slide level2">
<h2>Referências</h2>
<ul>
<li class="fragment"><a href="https://otexts.com/fpp3/">Hyndman, R.J., &amp; Athanasopoulos, G. (2021). Forecasting: principles and practice, 3rd edition, OTexts: Melbourne, Australia. OTexts.com/fpp3.</a>. Chapter 7.</li>
<li class="fragment">Krispin, R. (2019). Hands-On Time Series Analysis with R: Perform time series analysis and forecasting using R. Packt Publishing Ltd.&nbsp;Chapter 9</li>
</ul>

</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="imagens/imecc.png" class="slide-logo"></p>
<div class="footer footer-default">
<p>Carlos Trucíos (IMECC/UNICAMP) | ME607 - Séries Temporais | <a href="https://ctruciosm.github.io/">ctruciosm.github.io</a></p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="Aula06_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="Aula06_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="Aula06_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="Aula06_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="Aula06_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="Aula06_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="Aula06_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="Aula06_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="Aula06_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="Aula06_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="Aula06_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1600,

        height: 900,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>